# For installing library packages
install.packages("ggplot2")
install.packages("gridExtra")

# For loading library
library("ggplot2")
library("gridExtra")
library(dplyr)

# Create data 
set.seed(10)
home = sample(c('Buy', 'Rent'), 380, replace = TRUE)
status= sample(c('Married', 'Single', 'Dating'), 380, replace = TRUE)
housing_data = data.frame(home = as.factor(home), status = as.factor(status))

head(housing_data,10)

#frequency table
table1 = table(housing_data$home)
table2 = table(housing_data$status)
print(table1)
print(table2)

prop.table(table1)
prop.table(table2)

# Create a data frame for home preference
home_data <- as.data.frame(table(housing_data$home))
colnames(home_data) <- c("home", "count")
# Create a data frame for relationship status
status_data <- as.data.frame(table(housing_data$status))
colnames(status_data) <- c("status", "count")

home_data
status_data

# Create the bar plots
p1 <- ggplot(home_data, aes(x = home, y = count, fill = home)) +
  geom_bar(stat = "identity") +
  labs(y = "Number of participants", title = "Distribution by Home Preference") +
  theme_minimal()
print(p1)

p2 <- ggplot(status_data, aes(x = status, y = count, fill = status)) +
  geom_bar(stat = "identity") +
  labs(y = "Number of participants", title = "Distribution by Relationship Status") +
  theme_minimal()

p2

#To create a Contingency Table we can use the "table function" in R
table(housing_data$home,housing_data$status)

#To find the Marginals (totals of the rows and columns)
housing_table <- table(housing_data$home, housing_data$status)
# Create a marginal table
marginal_table <- addmargins(housing_table)
# Print the marginal table
print(marginal_table)

# Compute the row percentages
row_percentages <- prop.table(housing_table, 1) * 100
# Compute the column percentages
col_percentages <- prop.table(housing_table, 2) * 100
print(row_percentages)
print(col_percentages)

# Create a pie chart with percentages for relationship status by home preference
ggplot(percentage_data, aes(x = "", y = percentage, fill = status)) +
  geom_bar(width = 1, stat = "identity", position = "fill") +
  coord_polar("y") +
  geom_text(aes(label = sprintf("%.1f%%", percentage)), 
            position = position_fill(vjust = 0.5), size = 3) +
  labs(title = "Relationship Status Distribution by Home Preference", fill = "Relationship Status") +
  scale_fill_manual(values = c("Married" = "red", "Dating" = "pink",
                               "Single" = "lightblue")) +
  facet_wrap(~ home) +
  theme_void()
